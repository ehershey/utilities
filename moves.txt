Setting up access to the Moves API (https://dev.moves-app.com/)

1) Set $CLIENT_ID and $CLIENT_SECRET from https://dev.moves-app.com/apps/8fIA4X85c3PUf5a4szvc9t7A3pvhU0O8/edit ("Development" tab)

2) Visit in a browser:
#https://api.moves-app.com/oauth/v1/authorize?response_type=code&client_id=<client_id>&scope=<scope>
open "https://api.moves-app.com/oauth/v1/authorize?response_type=code&client_id=$CLIENT_ID&scope=activity%20location"

3) Enter the code into your app.

4) You'll get redirected (in your browser, not from the app) to a URL like this:

http://moves.ernie.org/redirect?code=xxxxxxxxxxx&state=

5) Pull code out and set to $AUTH_CODE

# copy URL, then run
export AUTH_CODE="$(pbpaste | sed 's/.*code=\(.*\)\&.*/\1/')"

6) Get tokens from API:

curl  --data "grant_type=authorization_code&code=$AUTH_CODE&client_id=$CLIENT_ID&client_secret=$CLIENT_SECRET&redirect_uri=http://moves.ernie.org/redirect" "https://api.moves-app.com/oauth/v1/access_token"

# response looks like:
{"access_token":"xxxxx","token_type":"bearer","expires_in":15551999,"refresh_token":"yyyyy","user_id":zzzzzzzzz}

7) Set access token to $MOVES_ACCESS_TOKEN and save refresh token for next refresh

Refreshing access token:
# (Still generates new access token but doesn't require re-authing in app or using browser)
curl --data "grant_type=refresh_token&refresh_token=$REFRESH_TOKEN&client_id=$CLIENT_ID&client_secret=$CLIENT_SECRET" https://api.moves-app.com/oauth/v1/access_token
